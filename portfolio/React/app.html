<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>React</title>
    <link rel="shortcut icon" href="logo.png" type="image/png">
    <link rel="stylesheet" href="index.css">
    <script src="scripts/reacr.js"></script>
    <script src="scripts/react2.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>
    <div id="app"></div>
		<script  type="text/babel">
		class Block extends React.Component {
    constructor(props) {
        super(props);
        this.state = {
            items: [{ value: "Что то очень важное", id: 1,edit:false }],edit:false,
          };
         this.id=this.state.items.length;
    }
    addList=()=>{
        this.id=this.id+1;
        var test_arr=this.state.items;
        var newTask={value:"Что то очень важное",id:this.id,edit:false};
        test_arr.push(newTask);
        this.setState({items:test_arr});
    }
    deleteList=(i)=>{
        var test_arr = this.state.items;
        test_arr.splice(i,1);
        test_arr.map((item,i)=>{
            item.id=i+1;
        });
        this.id=this.state.items.length;
        this.setState({ items: test_arr });
    }
    testRender=(i, value)=>{
        var test_arr = this.state.items;
        test_arr[i].value=value;
        this.setState({ items: test_arr });
    }
    dedaultEdit=()=>{
        var test_arr = this.state.items;
        test_arr[0].edit=false;
        this.setState({ items: test_arr });
    }
    renderNorm=()=>{
        var arr=this.state.items;
        var ret =[];
        for(var i=0;i<arr.length;i++){
            ret[i] = <List default={this.dedaultEdit} edit={arr[i].edit} save={this.testRender}  del={this.deleteList} value={arr[i].value} id={arr[i].id} />
        }
        return ret
            
    
    }
    render(){
        return (
            <div id="root">
                {this.renderNorm()}
                <button className="btn_add" onClick={this.addList}>Добавить</button>
                </div>
        )
           
        
    }
}
class List extends React.Component{
    constructor(props){
        super(props);
        this.state = ({ edit: this.props.edit,text:"Что то очень важное"})
    }
    renderEdit=()=>{
        return(
        <div className="task">
            <textarea ref="textarea" placeholder={this.state.text} id="textarea" ></textarea>
            <button onClick={this.save} className="btn_save">Сохранить</button>
        </div>
        )
    }
    edit=()=>{
        this.props.default();
    
        this.setState({edit:true})
        this.refs.textarea.placeholder='23';
        
    }
    save=()=>{
        this.setState({ edit: false })
        var text=this.refs.textarea.value;
        if(text!=''){
        this.props.save(this.props.id-1,text);
        this.setState({text:text});
        }
    }
    test=()=>{
        this.props.del(this.props.id-1);
    }
    renderNorm=()=>{
        return (
            <div>
                        <div width="600px" className="task">
                            {this.props.id}
                            <div className="task_text">{this.props.value}</div>
                            <button onClick={this.edit} className="btn_edit">Редактировать</button>
                            <button onClick={this.test}  className="btn_delete">Удалить</button>
                        </div>  
            </div>
        )
    }
    render(){
        if(this.state.edit==false)
      return this.renderNorm();
      else return this.renderEdit();
    }
}
ReactDOM.render(<Block />, document.getElementById("app"));
    	</script>
  </body>
</html>